-- Generiert von Oracle SQL Developer Data Modeler 22.2.0.165.1149
--   am/um:        2024-06-30 19:29:20 MESZ
--   Site:      Oracle Database 11g
--   Typ:      Oracle Database 11g



-- predefined type, no DDL - MDSYS.SDO_GEOMETRY

-- predefined type, no DDL - XMLTYPE

CREATE TABLE benachrichtigung (
    id             NUMBER NOT NULL,
    nachricht      VARCHAR2(250),
    datum          DATE,
    typ            VARCHAR2(50) NOT NULL,
    kunde_kunde_id NUMBER NOT NULL
);

CREATE TABLE fahrzeug (
    id             NUMBER NOT NULL,
    marke          VARCHAR2(200),
    modell         VARCHAR2(200),
    baujahr        DATE,
    kennzeichen    VARCHAR2(50),
    fahrzeug_id    NUMBER NOT NULL,
    kunde_kunde_id NUMBER NOT NULL
);

ALTER TABLE fahrzeug ADD CONSTRAINT fahrzeug_pk PRIMARY KEY ( fahrzeug_id );

CREATE TABLE kunde (
    id            NUMBER NOT NULL,
    vorname       VARCHAR2(200),
    nachname      VARCHAR2(200),
    email         VARCHAR2(200),
    telefonnummer VARCHAR2(200),
    adresse       VARCHAR2 
--  ERROR: VARCHAR2 size not specified 
    ,
    kunde_id      NUMBER NOT NULL
);

ALTER TABLE kunde ADD CONSTRAINT kunde_pk PRIMARY KEY ( kunde_id );

CREATE TABLE service (
    id               NUMBER NOT NULL,
    bezeichnung      VARCHAR2(250),
    beschreibung     VARCHAR2(255),
    dauerinstunden   NUMBER,
    kosten           NUMBER,
    serviceintervall NUMBER,
    service_id       NUMBER NOT NULL
);

ALTER TABLE service ADD CONSTRAINT service_pk PRIMARY KEY ( service_id );

CREATE TABLE service_termin (
    service_service_id NUMBER NOT NULL,
    termin_termin_id   NUMBER NOT NULL
);

ALTER TABLE service_termin ADD CONSTRAINT service_termin_pk PRIMARY KEY ( service_service_id,
                                                                          termin_termin_id );

CREATE TABLE termin (
    id             NUMBER NOT NULL,
    datum          DATE,
    uhrzeit        DATE,
    status         VARCHAR2(50),
    notizen        VARCHAR2(250),
    termin_id      NUMBER NOT NULL,
    kunde_kunde_id NUMBER NOT NULL
);

ALTER TABLE termin ADD CONSTRAINT termin_pk PRIMARY KEY ( termin_id );

CREATE TABLE wartungsverlauf (
    id                    NUMBER NOT NULL,
    datum                 DATE,
    beschreibung          VARCHAR2(250),
    kosten                NUMBER,
    naechsterservicedatum DATE,
    fahrzeug_fahrzeug_id  NUMBER NOT NULL,
    service_service_id    NUMBER NOT NULL
);

ALTER TABLE benachrichtigung
    ADD CONSTRAINT benachrichtigung_kunde_fk FOREIGN KEY ( kunde_kunde_id )
        REFERENCES kunde ( kunde_id );

ALTER TABLE fahrzeug
    ADD CONSTRAINT fahrzeug_kunde_fk FOREIGN KEY ( kunde_kunde_id )
        REFERENCES kunde ( kunde_id );

ALTER TABLE service_termin
    ADD CONSTRAINT service_termin_service_fk FOREIGN KEY ( service_service_id )
        REFERENCES service ( service_id );

ALTER TABLE service_termin
    ADD CONSTRAINT service_termin_termin_fk FOREIGN KEY ( termin_termin_id )
        REFERENCES termin ( termin_id );

ALTER TABLE termin
    ADD CONSTRAINT termin_kunde_fk FOREIGN KEY ( kunde_kunde_id )
        REFERENCES kunde ( kunde_id );

ALTER TABLE wartungsverlauf
    ADD CONSTRAINT wartungsverlauf_fahrzeug_fk FOREIGN KEY ( fahrzeug_fahrzeug_id )
        REFERENCES fahrzeug ( fahrzeug_id );

ALTER TABLE wartungsverlauf
    ADD CONSTRAINT wartungsverlauf_service_fk FOREIGN KEY ( service_service_id )
        REFERENCES service ( service_id );
/*
CREATE SEQUENCE fahrzeug_fahrzeug_id_seq START WITH 1 NOCACHE ORDER;

CREATE OR REPLACE TRIGGER fahrzeug_fahrzeug_id_trg BEFORE
    INSERT ON fahrzeug
    FOR EACH ROW
    WHEN ( new.fahrzeug_id IS NULL )
BEGIN
    :new.fahrzeug_id := fahrzeug_fahrzeug_id_seq.nextval;
END;
/

CREATE SEQUENCE kunde_kunde_id_seq START WITH 1 NOCACHE ORDER;

CREATE OR REPLACE TRIGGER kunde_kunde_id_trg BEFORE
    INSERT ON kunde
    FOR EACH ROW
    WHEN ( new.kunde_id IS NULL )
BEGIN
    :new.kunde_id := kunde_kunde_id_seq.nextval;
END;
/

CREATE SEQUENCE service_service_id_seq START WITH 1 NOCACHE ORDER;

CREATE OR REPLACE TRIGGER service_service_id_trg BEFORE
    INSERT ON service
    FOR EACH ROW
    WHEN ( new.service_id IS NULL )
BEGIN
    :new.service_id := service_service_id_seq.nextval;
END;
/

CREATE SEQUENCE termin_termin_id_seq START WITH 1 NOCACHE ORDER;

CREATE OR REPLACE TRIGGER termin_termin_id_trg BEFORE
    INSERT ON termin
    FOR EACH ROW
    WHEN ( new.termin_id IS NULL )
BEGIN
    :new.termin_id := termin_termin_id_seq.nextval;
END;
/



-- Zusammenfassungsbericht f√ºr Oracle SQL Developer Data Modeler: 
-- 
-- CREATE TABLE                             7
-- CREATE INDEX                             0
-- ALTER TABLE                             12
-- CREATE VIEW                              0
-- ALTER VIEW                               0
-- CREATE PACKAGE                           0
-- CREATE PACKAGE BODY                      0
-- CREATE PROCEDURE                         0
-- CREATE FUNCTION                          0
-- CREATE TRIGGER                           4
-- ALTER TRIGGER                            0
-- CREATE COLLECTION TYPE                   0
-- CREATE STRUCTURED TYPE                   0
-- CREATE STRUCTURED TYPE BODY              0
-- CREATE CLUSTER                           0
-- CREATE CONTEXT                           0
-- CREATE DATABASE                          0
-- CREATE DIMENSION                         0
-- CREATE DIRECTORY                         0
-- CREATE DISK GROUP                        0
-- CREATE ROLE                              0
-- CREATE ROLLBACK SEGMENT                  0
-- CREATE SEQUENCE                          4
-- CREATE MATERIALIZED VIEW                 0
-- CREATE MATERIALIZED VIEW LOG             0
-- CREATE SYNONYM                           0
-- CREATE TABLESPACE                        0
-- CREATE USER                              0
-- 
-- DROP TABLESPACE                          0
-- DROP DATABASE                            0
-- 
-- REDACTION POLICY                         0
-- 
-- ORDS DROP SCHEMA                         0
-- ORDS ENABLE SCHEMA                       0
-- ORDS ENABLE OBJECT                       0
-- 
-- ERRORS                                   1
-- WARNINGS                                 0
